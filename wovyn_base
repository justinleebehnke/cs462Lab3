ruleset wovyn_base {
  meta {
    
  }
  
  global {
    
  }
  
  rule process_heartbeat {
    select when wovyn heartbeat
    pre {
      genericThing = event:attrs{"genericThing"}.klog("genericThing")
    }
    if genericThing then
      send_directive("Wovyn Heartbeat Detected")
    fired {
      raise wovyn event "new_temperature_reading"
      attributes { 
        "temperature":genericThing{"data"}{"temperature"}[0]{"temperatureF"}, 
        "timestamp": time:now()
      }
    }
  }
  
  rule process_new_temp {
    select when wovyn new_temperature_reading
    pre {
      tempF = event:attrs{"temperature"}.klog("temperature content")
      timestamp = event:attrs{"timestamp"}.klog("time stamp value")
    }
    
  }
}
